# Tholos Assistant Contract

## Scope
- Propose unified diffs or full-file blobs only.
- All patches must pass scripts/verify.sh locally and in CI before merge.

## Don’ts
- No mixed, unrelated changes in one patch.
- No signature changes without updating all call sites and tests in the same patch.
- No bypassing pre-commit/CI except in hotfix/*.

## Required Invariants
- Viz API: tholos.sim.viz.render_frame(G, water, veg, danger, agents, preds, houses, game_k=None, game=None, scale=2, side_panel=None)
- Engine entry: run_sim(cfg) and CLI: python -m tholos.cli.run_sim --config configs/base.yaml → out/<tag_timestamp>/artifacts/{composite.png, composite.gif, viewer.html}

## Required Steps Before Proposing Code
1) Run scripts/verify.sh locally and capture output.
2) Provide a single focused patch with tests.
3) Include a rollback plan.

## PR Template (include in description)
- Problem statement
- Approach
- Files changed
- Test plan (exact commands + expected outputs)
- Risk / Rollback

## Patch Format Examples
*** Begin Patch
*** Update File: src/tholos/sim/engine.py
@@
-def run_sim(cfg):
+def run_sim(cfg):
     pass
*** End Patch

*** Begin Patch
*** Add File: docs/STATUS.md
+Current Status
+Smoke run: pending
*** End Patch
