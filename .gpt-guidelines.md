# Tholos Assistant Contract

## Scope
- Propose **unified diffs** or **full-file blobs** only. No freehand or regex patching.
- All patches must pass `scripts/verify.sh` locally and in CI before merge.

## Donâ€™ts
- No mixing unrelated concerns in one patch.
- No function signature changes without updating **all** call sites and tests in the same patch.
- No bypassing pre-commit/CI except emergency `hotfix/*` branches.

## Required Invariants
- Viz API (canonical):
  `tholos.sim.viz.render_frame(G, water, veg, danger, agents, preds, houses, game_k=None, game=None, scale=2, side_panel=None)`
- Engine entry:
  `run_sim(cfg)` and CLI `python -m tholos.cli.run_sim --config configs/base.yaml`
  must produce `out/<tag_timestamp>/artifacts/{composite.png, composite.gif, viewer.html}`.

## Required Steps Before Proposing Code
1) Run `scripts/verify.sh` locally; capture the full output.
2) Provide a **single focused** patch with tests.
3) Include a rollback plan.

## PR Template (paste into the PR description)
- Problem statement
- Approach
- Files changed
- Test plan (exact commands + expected outputs)
- Risk / Rollback

## Patch Format Examples

*** Begin Patch
*** Update File: src/tholos/sim/engine.py
@@
-def run_sim(cfg):
-    ...
+def run_sim(cfg):
+    ...
*** End Patch

*** Begin Patch
*** Add File: docs/STATUS.md
+Current Status
+Smoke run: pending
*** End Patch
